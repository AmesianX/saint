\section{Experimental Evaluation}\label{sec:evaluation}
We evaluated our taint analysis by attempting to detect
format string vulnerabilities of \texttt{printf}-like functions
in four different open-source C programs ({\tt mongoose, vlc,
claws, apache}). 

In the C programming language, \textit{format string vulnerabilities}
happen a call to a variable-length function has an incorrect number
of arguments. For instance, a call such as
\begin{center}
{\tt printf(buf);} // format string vulnerability
\end{center}
may cause the program to crash because the function \texttt{printf}
expects its first parameter to be a format string. For
instance {\tt printf("\%s", buf)} would be a correct call.

For this experiment, the taint analysis emits a warning
whenever a format string vulnerability is encountered,
or whenever a tainted variable is used in a sink function
(e.g. \texttt{snprintf}).
We ran the analysis on an \texttt{Intel i7 @ 3.4GHz} with
$4$ cores and $16$ GB of RAM, running {\tt Debian Wheezy}.

Table~\ref{tab:results} shows the analysis results of the
taint analysis, ran in the following order: intraprocedural
analysis, context-sensitive analysis, and context-insensitive
analysis.
The first column of the table entails the program name and
its version in parenthesis.
\begin{table}[!hbtp]
\centering
\begin{tabular}{|l|c|c|c|c|}
\hline
{\bf Program}				&	{\bf Description}	&	{\bf SLOC}	& {\bf Warnings}	&	{\bf Time}	\\ \hline
{\tt mongoose}	($4.1$)		&	Web server			&	$4k$		&	$26$			&	$56s$ 	\\ %\hline
{\tt vlc-input}	($2.1.2$)		&	Media player		&	$16k$		&	$0$				&	$6s$ 	\\ %\hline
{\tt claws}		($3.9.3$)	&	Email client		& 	$142k$ 		&	$183$			&	$11s$		\\ %\hline
{\tt apache}	($2.4.7$)	&	Web server			&	$144k$		&	n/a				&	n/a	 		\\ \hline
\end{tabular}\caption{Taint Analysis Evaluation Results}\label{tab:results}
\end{table}

\paragraph{Discussion}

Our implementation used for this evaluation implements taint
propagation only for basic C language elements:
\begin{itemize}
  \item Assignment operations
  \item Copy and Store of pointers and scalar variables
\end{itemize} 
In future work, we plan to add taint propagation for other
C language elements such as {\tt casts, bit operations}.

We could not get the taint analysis running on the \texttt{apache}
web server because of a crash happening during initialization of
the \texttt{DSA} points-to analysis.

We note that the analysis of \texttt{vlc-input} (the input module of
\texttt{vlc}) with only $16k$ LOC requires more analysis time than
\texttt{claws} which has $144k$ LOC. We believe this is due to the
high amount of tainted values within \texttt{vlc-input}. Because
of the high amount of tainted values, the analysis spends more time
when checking if a value (argument of call) is tainted or not.

We believe that our current implementation performs in an acceptable
time, since the developer has to wait for a maximum of $56$ seconds
for a project with around $140k$ lines of code.
