\documentclass[12pt,onecolumn,a4paper]{article}
\usepackage{amsmath,amssymb,graphicx,algorithmic,xspace,url,latexsym}

\usepackage[parfill]{parskip}
\usepackage{paralist}
\usepackage{times}
\usepackage{textcomp}
\usepackage{verbatim}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{adjustbox} %To color the backround of the verbatim environment
\usepackage{verbatim} 
\definecolor{shadecolor}{rgb}{.9, .9, .9} %To color the backround of the verbatim environment

%To color the backround of the verbatim environment
\newenvironment{verbatim_color}%
   {\par\noindent\adjustbox{margin=1ex,bgcolor=shadecolor,margin=0ex \medskipamount}\bgroup\minipage\linewidth\verbatim}%
   {\endverbatim\endminipage\egroup}

\begin{comment}
\hypersetup{
   	linkbordercolor=purple
}
\end{comment}

\setlength{\evensidemargin}{-0.1in} \setlength{\oddsidemargin}{-0.1in}
\setlength{\textwidth}{6.5in} \setlength{\textheight}{9.0in}
\setlength{\topmargin}{-0.5in}
%\setlength{\headheight}{0in}

\definecolor{forestgreen}{RGB}{34,139,34}    
\definecolor{mediumblue}{RGB}{0,0,205}    
\definecolor{firebrickred}{RGB}{178,34,34}

\newcommand{\saint}{\texttt{\textsc{saint}}\xspace}
\newcommand{\software}[2]{\texttt{\textbf{#1}, version #2}\xspace}
\newcommand{\softwarenov}[1]{\texttt{\textbf{#1}}\xspace}
\newcommand{\tool}[1]{\texttt{#1}\xspace}
\newcommand{\command}[1]{\textcolor{mediumblue}{\texttt{\textbf{"#1"}}}\xspace}
\newcommand{\script}[1]{\texttt{#1}\xspace}

\newcommand{\env}[1]{\textcolor{firebrickred}{\text{#1}}\xspace}
\newcommand{\envout}[1]{\textcolor{firebrickred}{\$\text{#1}}\xspace}

\newcommand{\mycheckmark}[1]{\textcolor{#1}{$\checkmark$}}

%Remove widows and orphants
\clubpenalty = 10000
\widowpenalty = 10000
\displaywidowpenalty = 10000 

\sloppypar
\begin{document}
\pagestyle{empty}

\author{Xavier NOUMBISSI NOUNDOU}

\begin{center}
\begin{LARGE}
\textbf{ \textsc{Saint: Simple Taint Analysis Tool\\
				User's manual}}\\
\end{LARGE}
\begin{large}
\vspace{0.3cm}
by\\
\vspace{0.3cm}
\texttt{ \bf \textit{Dipl.-Inf. Xavier Noumbissi Noundou\\
xavier.noumbis@gmail.com}}\\
\vspace{0.3cm}
\today{}\\
\vspace{1.3cm}
\end{large}
\end{center}

\tableofcontents

\section{Abstract}
Businesses increasingly use software. This is even more
relevant for companies relying on e-commerce. However,
software is error-prone and contain several bugs. Security
bugs are one of the major problems faced by companies today.
In the worst case, security bugs enable unauthorized users
to gain full control of an application.

My PhD thesis introduces the concept of 
\textcolor{firebrickred}{\textit{tainted paths}} and
describes techniques and algorithms to compute them in
any imperative programming language that uses
pointers (C, C++, Java, etc.). I implemented these
algorithms in \saint.

\saint does not require the developer to annotate
the program under analysis. \saint implements a
flow-sensitive, interprocedural and context-sensitive
analysis that computes tainted paths in C programs
at compile-time.

\section{Installation Instructions}
This section of the manual explains how to install \saint
on a ''Linux'' machine. We have not tested \saint on a ''Windows''
or ''Mac OS'' machine, but the installation should follow similar steps. 

\subsection{Required Software}
This section enumerates all software that you need to run \saint.
\begin{enumerate}[a)]
	\item \saint: \url{https://github.com/xnoumbis/saint.git}
	
	\item The compiler infrastructure \software{LLVM}{3.3} (\url{http://llvm.org})
	
	\item The precompiled \tool{LLVM}'s tool chain \software{clang+llvm}{3.3}
	which include binaries like \tool{clang}, \tool{llvm-link}, etc.
	
	\item The DSA pointer analysis \softwarenov{poolalloc}
	(\url{https://github.com/llvm-mirror/poolalloc.git}).
\end{enumerate}

\subsection{Environment Variables}
Table~\ref{table_env} that shows all environment variables
that you have to define and export in order to successfully
run \saint.

\begin{table*}[!htbp]
\begin{center}
\begin{tabular}{|r|l|} \hline
{\bf Environment variables}	&	{\bf Description}	\\ \hline \hline
\env{SAINT\_HOME}	&	\saint home folder (e.g.: /home/user/saint) 	\\ \hline
\env{SAINT\_BIN}	&	\saint binaries folder (e.g.: /home/user/saint/bin) 	\\ \hline
\env{LLVM\_HOME}	&	\tool{llvm} home folder (e.g.: /home/user/llvm)		\\ \hline
\env{LLVM\_LIB}		&	\tool{llvm} compiled libraries folder 					\\
					&    (e.g.: \envout{LLVM\_HOME}/build/Release+Asserts/lib)	\\ \hline
\env{LLVM\_BIN}		&	\tool{llvm} compiled binaries					\\
					&    (e.g.: \envout{LLVM\_HOME}/build/Release+Asserts/bin)	\\ \hline	
\env{POOLALLOC}		&	\tool{poolalloc} home folder (e.g.: /home/user/poolalloc) \\ \hline		
\env{CLANGLLVM\_BIN}&	\tool{clang+llvm} binaries' folder	\\
					& 	(e.g.: /home/user/clang+llvm/bin) \\ \hline	
\end{tabular}
\end{center}
\caption{Table with all environment variables required to install and use \saint}\label{table_env}
\end{table*}

\mycheckmark{mediumblue} You define and export an environment variable \env{ENV\_VAR} by
writing the following commands in your ''\texttt{.bashrc}'' file:
\begin{verbatim}
	ENV_VAR=path_to_folder
	export ENV_VAR
\end{verbatim}

\subsection{How to Configure ''\tool{clang+llvm}'' for use with \textsc{saint}}
\begin{enumerate}[a)]
	\item Download and unpack \software{clang+llvm}{3.3}.
	
	\item Add the \texttt{bin} folder to your environment variable \env{PATH}.\\
	\mycheckmark{mediumblue} For instance by adding the following line
	in your file ''\texttt{.bashrc}''
	\begin{verbatim}
		PATH=$PATH:$CLANGLLVM_BIN
		export PATH
	\end{verbatim}
\end{enumerate}

\subsection{How to Configure ''\tool{LLVM}'' for use with \textsc{saint}}
\begin{enumerate}[a)]
	\item Create a folder \texttt{build} in \envout{LLVM\_HOME}.

	\item Copy and customized the script \script{configure-llvm.sh}
	from \saint's \texttt{script} folder into the newly created 
	\texttt{build} folder.

	\item Create a symbolic link to \saint sources in the folder
	''\texttt{\$LLVM\_HOME/lib/Analysis}''.
	You can achieve this by running: 
	\command{ln -s \$SAINT\_HOME/src \$LLVM\_HOME/lib/Analysis/saint}.
	
	\item Open the file ''\texttt{\$LLVM\_HOME/lib/Analysis/Makefile}'' and
	append the string "saint" to the ''DIRS'' variable.
	Following is an excerpt of the file.\\
	
	\begin{verbatim}
##===- lib/Analysis/Makefile -------------------------------*- Makefile -*-===##
#
#                     The LLVM Compiler Infrastructure
#
# This file is distributed under the University of Illinois Open Source
# License. See LICENSE.TXT for details.
#
##===----------------------------------------------------------------------===##

LEVEL = ../..
LIBRARYNAME = LLVMAnalysis
DIRS = IPA saint
BUILD_ARCHIVE = 1

include $(LEVEL)/Makefile.common
	\end{verbatim}		
	
	\item Run the script \script{configure-llvm.sh} within the \texttt{build}
	folder: \command{cd \$LLVM\_HOME/build; ./configure-llvm.sh}.
	
	\item Run the command \texttt{make} within the \texttt{build} folder: 
	\command{cd \$LLVM\_HOME/build; make}.
	
	\item After the previous step, you can run \texttt{make} from the \saint
	source folder during the development:	
	\command{cd \$LLVM\_HOME/lib/Analysis/saint; make -f Makefile.saint}.
\end{enumerate}


\subsection{How to Configure ''\tool{poolalloc}'' for use with \textsc{saint}}
\begin{enumerate}[a)]
	\item The sources of the DSA pointer analysis \softwarenov{poolalloc}
	can be gathered using the command 
	\command{git clone https://github.com/llvm-mirror/poolalloc.git}.

	\item After getting the sources of \tool{poolalloc}, the user
	has to checkout the \tool{git} version under commit
	'181c62f1d29ae9de660bad0a6593130d15803abc' using the command
	\command{git checkout 181c62f1d29ae9de660bad0a6593130d15803abc}.

	\item Copy and customized the script \script{configure-poolalloc.sh}
	from \saint's \texttt{script} folder into \envout{POOLALLOC}, and
	run it.
	
	\item Then run \command{make}, and \command{make install}. Make sure
	to run \command{make install} as \texttt{root} (or \texttt{administrator}
	on a \texttt{Windows} system).
	
	\item Create a symbolic link to \tool{poolalloc}'s dsa include folder
	in the folder \texttt{\$LLVM\_HOME/include}.
	You can achieve this by running: 
	\command{ln -s \$POOLALLOC/include/dsa \$LLVM\_HOME/include/dsa}.
\end{enumerate}

\section{Compiling and Running \textsc{saint}}

\mycheckmark{mediumblue} You need to execute the command
\command{make -f Makefile.saint} within the
folder ''\texttt{\$LLVM\_HOME/lib/Analysis/saint}'' to compile
\saint.

Also, \saint gets compiled when you run it using
the Bash script \texttt{runOpt.sh}.

\subsection{Folder Structure}
The following folders constitute \saint's directory structure:
\begin{enumerate}[1)]
	\item \texttt{bin}: folder with the scripts:
	\begin{enumerate}[a)]
		\item \texttt{saint-gen-ir.sh}: generates the LLVM IR for code analyzed by \saint.
		\item \texttt{saint-run-opt.sh}: runs LLVM (\texttt{opt} binary) with \saint as plugin.
	\end{enumerate}
	
	\item \texttt{benchmarks}: folder with sample
	scripts to run \saint.

	\item \texttt{cfg}: folder with source, sink, and sanitizer configuration files
		
	\item \texttt{projects}: folder with sample projects.	

	\item \texttt{doc}: folder with the manual.

	\item \texttt{scripts}: folder with the scripts:
	\begin{itemize}[a)]
		\item \texttt{configure-llvm.sh}: can be used to configure \softwarenov{LLVM} for \saint.	
		\item \texttt{configure-poolalloc.sh} can be used to configure \softwarenov{poolalloc} for \saint.	
	\end{itemize}
	
	\item \texttt{src}: folder with all \texttt{C++} source files,
	and \tool{Bash} scripts to compile and run \saint.			
\end{enumerate}

\subsection{Configuration Files}

Configuration files are found in the folder ''\texttt{\$SAINT\_HOME/cfg}''.
There are three configuration files:
\begin{enumerate}[1)]
	\item \texttt{sources.cfg}: taint sources configuration file\\
		  Each line of the file specifies a function name and an integer ''\texttt{x}''.
		  ''\texttt{x}'' is the argument of the function that is tainted.\\
		  If ''\texttt{x}'' is zero (0), then it is the return value of the function that is tainted.
		  \begin{verbatim}
		  fopen,0
		  fgets,1		  
		  \end{verbatim}
		  The previous lines specify that \texttt{fopen} returns a tainted value, and
		  that \texttt{fgets} taints its first argument. 
	\item \texttt{sinks.cfg}: taint sinks configuration file\\
		  Each line of the file specifies a function name and an integer ''\texttt{y}''.
		  ''\texttt{y}'' is the argument of the function that must not received a tainted value.\\
		  ''\texttt{y}'' is never equal to zero (0), then it is the return
		  value of the function that is tainted.
		  \begin{verbatim}
		  sprintf,1	  
		  \end{verbatim}
		  The previous line denotes that \texttt{sprintf} must not received
		  a tainted value as its first argument (i.e. \texttt{sprintf} is 
		  sensible function.
	\item \texttt{sanitizers.cfg}: sanitizers configuration file\\
		  \saint doesn't yet implement this functionality.
\end{enumerate}

\subsection{Running \textsc{saint}}
Among others, \saint source folder contains the following two important
\texttt{Bash} scripts:
\begin{enumerate}[1)]
	\item \texttt{saint-gen-ir.sh}: this script is used to generate and
		merge \tool{llvm} intermediate representation (IR) files. 
	
	\item \texttt{saint-run-opt.sh}: this script is used to run the analysis of
		\saint on the program under analysis.
\end{enumerate}

We encourage users to look at the sample scripts in the
folders ''\texttt{projects}'' and ''\texttt{benchmarks}''
to learn how to use \texttt{saint-gen-ir.sh} and
\texttt{saint-run-opt.sh}.
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{plain}
\bibliography{manual-saint}

\end{document}
